```{r display VeggieMeter Score change from baseline for the bold study, ft.align = "left"}
#| echo: false
#| results: asis
#| eval: !expr params$bold_veggiemeter

vmdf <-
  BRIDGE21::get_database_values(
    !!date,
    veggiemeter,
    data = data
  )

colnames(vmdf)[which(colnames(vmdf) == "veggiemeter")] <- "Score"

if (nrow(vmdf) > 0 & all(!is.na(vmdf$Score))) {
  BRIDGE21::format_quarto(
    "sections/lifestyle/latex/veggiemeter.tex",
    type = "input"
  )

  vmdf <- vmdf %>%
    dplyr::arrange(!!date) %>%
    dplyr::mutate(
      baseline_score = dplyr::first(Score),
      percent_change = ((Score - baseline_score) / baseline_score) * 100,
      Interpretation = dplyr::case_when(
        is.na(percent_change) | percent_change == 0 ~ "Baseline measurement",
        percent_change > 5 ~ paste0(
          "Nice job! You increased your fruit and vegetable intake by ",
          round(abs(percent_change), 1),
          "%"
        ),
        percent_change < -5 ~ paste0(
          "Your fruit and vegetable intake decreased by ",
          round(abs(percent_change), 1),
          "%"
        ),
        TRUE ~ "Your fruit and vegetable intake stayed about the same"
      ),
      Date = visit$formatted_date_of_visit
    ) %>%
    dplyr::select(Date, Score, Interpretation)

  vmdf %>%
    flextable::flextable() %>%
    flextable::width(j = 1, width = 0.75) %>%
    flextable::width(j = 2, width = 0.75) %>%
    flextable::width(j = 3, width = 4.5) %>%
    flextable::align(j = 1:3, part = "all", align = "center") %>%
    flextable::add_footer_row(
      values = "VeggieMeter Scores range from 0â€“800. Percent change calculated relative to baseline (first) measurement.",
      colwidths = 3
    ) %>%
    flextable::align(i = 1, part = "footer", align = "left")
}

BRIDGE21::format_quarto(type = "newpage")
```