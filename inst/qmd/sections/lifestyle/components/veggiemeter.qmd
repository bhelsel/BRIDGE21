```{r display VeggieMeter Score tabl for the bold study, ft.align = "left"}
#| echo: false
#| results: asis
#| eval: !expr params$bold_veggiemeter

date_var <- data$visitdt
vm_score <- data$veggiemeter

vmdf <-
  BRIDGE21::get_database_values(
    !!date,
    veggiemeter,
    data = data
  )

colnames(vmdf)[which(colnames(vmdf) == "veggiemeter")] <- "Score"

if (nrow(vmdf) > 0 & all(!is.na(vmdf$Score))) {
  BRIDGE21::format_quarto(
    "sections/lifestyle/latex/veggiemeter.tex",
    type = "input"
  )

  interpretation_labels <- c(
    "Your fruit and vegetable intake is low — try adding more into your diet.",
    "Your fruit and vegetable intake is good — keep it up!",
    "Your fruit and vegetable intake is excellent! Keep up the good work!"
  )
  vmdf %>%
    BRIDGE21::format_date(!!date_expr) %>%
    dplyr::mutate(
      # < 400 “Low”; ≥ 400 to < 600  “Good"; ≥ 600 “Excellent"
      Category = cut(
        Score,
        breaks = c(-Inf, 400, 600, Inf),
        labels = c("Low", "Good", "Excellent"),
        right = FALSE
      ),
      Interpretation = factor(
        Category,
        levels = c("Low", "Good", "Excellent"),
        interpretation_labels
      )
    ) %>%
    flextable::flextable() %>%
    flextable::width(j = 1:2, width = 0.75) %>%
    flextable::width(j = 3, width = 1) %>%
    flextable::width(j = 4, width = 4) %>%
    flextable::align(j = 1:4, part = "all", align = "center") %>%
    flextable::add_footer_row(
      values = "VeggieMeter Scores range from 0–800",
      colwidths = 4
    ) %>%
    flextable::align(i = 1, part = "head", align = "left")
}

BRIDGE21::format_quarto(type = "newpage")
```